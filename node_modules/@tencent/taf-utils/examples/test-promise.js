/**
 * Created by czzou on 16/10/19.
 */

var Promise=require("../").Promise;

function delayfn(){
    var dfd=Promise.defer();
    setTimeout(function () {
        console.log("==== resolved over  bluebird ====");
        dfd.resolve(111);
    },2000);
    return dfd.promise;
}

// 不写done，应该正常抛出异常
var errorfn=function () {
    var dfd=Promise.defer();
    setTimeout(function () {
        console.error("==== reject over  bluebird ====");
        try {
            //ttt();
            //console.lag("ad")
            dfd.reject(555);
        }
        catch (e){
            dfd.reject(e);
        }

    },2000);
    return dfd.promise;
}

delayfn().then(function (data) {
    console.log(data)
}).then(errorfn).fail(function(err){
    console.error("==== catch last ===",err);
});