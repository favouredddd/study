var path = require("path")
var TafSvr = require("../../../protal.js").server;
var TRom   = require("./NodeTafImp.js").TRom;

function StartServer(options){
    var option = new TafSvr.BindAdapterOption();
    option.endpoint  = options.endpoint;
    option.name      = "TRom.NodeTafServer.NodeTafObjAdapter";
    option.servant   = options.servant;
    option.handleImp = TRom.NodeTafImp;
    var svr = TafSvr.createServer();
    svr.start(option);
    return svr;
}

function StartAuthServer(){
    var svr = TafSvr.createServer();
    svr.initialize(path.resolve(__dirname ,"./TRom.NodeTafServer.config.conf"), function (server){
        server.addServant(TRom.NodeTafImp, server.Application + "." + server.ServerName + ".NodeTafObj");
    });
    svr.start();
    return svr;
}

module.exports = {
    StartServer     : StartServer,
    StartAuthServer : StartAuthServer
}