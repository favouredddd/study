/**
 * Created by czzou on 2016/12/16.
 */
var util=require("util");
var express=require("express");
var app=express();
var tafNodeTest=require("./proxy/TafNodeTest");


app.get("/",function(req,res){
    res.end("taf-nodejs 测试服务");
});
app.get("/getServerInfo",function(req,res){
    tafNodeTest.getServerInfo().then(function(stRsp){
        stRsp=stRsp.toObject();
        res.end(util.inspect(stRsp));
    }).catch(function(e){
        console.error(e);
        res.end("request error");
    });
});
app.get("/test_hash",function(req,res){
    tafNodeTest.getServerInfo_hash().then(function(stRsp){
        stRsp=stRsp.toObject();
        res.end(util.inspect(stRsp));
    }).catch(function(e){
        console.error(e);
        res.end("request error");
    });
});
app.get("/test_oneway",function(req,res){
    tafNodeTest.getServerInfo_oneway().then(function(stRsp){
        stRsp=stRsp.toObject();
        res.end(util.inspect(stRsp));
    }).catch(function(e){
        //console.error(e);
        res.end("test_oneway end");
    });
});
app.set('host', process.env.IP || 'localhost');
app.set('port', process.env.PORT || 8000);

var server=app.listen(app.get('port'), app.get('host'), function() {
    console.log('Express server listening on port', server.address().address,server.address().port);
})